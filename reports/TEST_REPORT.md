# 测试报告
## 环境检查
```text
conda_env: OK
pyzmq: OK
turbojpeg: OK
pynvml: FAIL
httpx: FAIL
onnxruntime_gpu: OK
ffmpeg: OK
missing_suggested: httpx>=0.24.0, pynvml>=11.5.0
```
## 性能测试
### 生产者-消费者流水线吞吐
```text
mode=pipeline pipeline_enabled=True accepted=300 dropped=0 submit_fps=5371.01 in_q=0 mid_q=0 decode=1 encode=1
mode=direct pipeline_enabled=False accepted=300 dropped=0 submit_fps=33982756.32 in_q=0 mid_q=0 decode=0 encode=0
```
### onnxruntime CPU/GPU 基准（如可用）
- 当前环境无法执行 onnxruntime 基准（缺少依赖或模型不兼容）。
## 可靠性测试
- 网络异常/断线恢复：提供集成脚本入口（依赖 `websockets` 或 `websocket-client` 时可扩展），本仓库默认不强制安装该依赖。
## 集成测试
- 新旧版本兼容：保留现有 `/video_in`、`/human_pic`、`/DFM`、`/m_blank` 等端点不变；新增端点在 `/api/v1/*` 下提供。
```text
smoke: OK
```
## 编解码能力探测
```json
{"ts": 1768884795.1257174, "ffmpeg": {"installed": true, "exe": "ffmpeg", "version_line": "ffmpeg version 6.1.1-3ubuntu5 Copyright (c) 2000-2023 the FFmpeg developers"}, "hwaccels": ["vdpau", "cuda", "vaapi", "qsv", "drm", "opencl", "vulkan"], "encoders": ["=", "=", "=", "=", "=", "=", "=", "=", "a64multi", "a64multi5", "alias_pix", "amv", "apng", "asv1", "asv2", "libaom-av1", "librav1e", "libsvtav1", "av1_nvenc", "av1_qsv", "av1_vaapi", "avrp", "avui", "ayuv", "bitpacked", "bmp", "cfhd", "cinepak", "cljr", "vc2", "dnxhd", "dpx", "dvvideo", "exr", "ffv1", "ffvhuff", "fits", "flashsv", "flashsv2", "flv", "gif", "h261", "h263", "h263_v4l2m2m", "h263p", "libx264", "libx264rgb", "h264_nvenc", "h264_qsv", "h264_v4l2m2m", "h264_vaapi", "hap", "hdr", "libx265", "hevc_nvenc", "hevc_qsv", "hevc_v4l2m2m", "hevc_vaapi", "huffyuv", "jpeg2000", "libopenjpeg", "jpegls", "libjxl", "ljpeg", "magicyuv", "mjpeg", "mjpeg_qsv", "mjpeg_vaapi", "mpeg1video", "mpeg2video", "mpeg2_qsv", "mpeg2_vaapi", "mpeg4", "libxvid", "mpeg4_v4l2m2m", "msmpeg4v2", "msmpeg4", "msrle", "msvideo1", "pam", "pbm", "pcx", "pfm", "pgm", "pgmyuv", "phm", "png", "ppm", "prores", "prores_aw", "prores_ks", "qoi", "qtrle", "r10k", "r210", "rawvideo", "roqvideo", "rpza", "rv10", "rv20", "sgi", "smc", "snow", "speedhq", "sunrast", "svq1", "targa", "libtheora", "tiff", "utvideo", "v210", "v308", "v408", "v410", "vbn", "vnull", "libvpx", "vp8_v4l2m2m", "vp8_vaapi", "libvpx-vp9", "vp9_vaapi", "vp9_qsv", "wbmp", "libwebp_anim", "libwebp", "wmv1", "wmv2", "wrapped_avframe", "xbm", "xface", "xwd", "y41p", "yuv4", "zlib", "zmbv", "aac", "ac3", "ac3_fixed", "adpcm_adx", "adpcm_argo", "g722", "g726", "g726le", "adpcm_ima_alp", "adpcm_ima_amv", "adpcm_ima_apm", "adpcm_ima_qt", "adpcm_ima_ssi", "adpcm_ima_wav", "adpcm_ima_ws", "adpcm_ms", "adpcm_swf", "adpcm_yamaha", "alac", "anull", "aptx", "aptx_hd", "libcodec2", "comfortnoise", "dfpwm", "dca", "eac3", "flac", "g723_1", "libgsm", "libgsm_ms", "mlp", "mp2", "mp2fixed", "libtwolame", "libmp3lame", "libshine", "nellymoser", "opus", "libopus", "pcm_alaw", "pcm_bluray", "pcm_dvd", "pcm_f32be", "pcm_f32le", "pcm_f64be", "pcm_f64le", "pcm_mulaw", "pcm_s16be", "pcm_s16be_planar", "pcm_s16le", "pcm_s16le_planar", "pcm_s24be", "pcm_s24daud", "pcm_s24le", "pcm_s24le_planar", "pcm_s32be", "pcm_s32le", "pcm_s32le_planar", "pcm_s64be", "pcm_s64le", "pcm_s8", "pcm_s8_planar", "pcm_u16be", "pcm_u16le", "pcm_u24be", "pcm_u24le", "pcm_u32be", "pcm_u32le", "pcm_u8", "pcm_vidc", "real_144", "roq_dpcm", "s302m", "sbc", "sonic", "sonicls", "libspeex", "truehd", "tta", "vorbis", "libvorbis", "wavpack", "wmav1", "wmav2", "ssa", "ass", "dvbsub", "dvdsub", "mov_text", "srt", "subrip", "text", "ttml", "webvtt", "xsub"], "decoders": ["=", "=", "=", "=", "=", "=", "=", "=", "012v", "4xm", "8bps", "aasc", "agm", "aic", "alias_pix", "amv", "anm", "ansi", "apng", "arbc", "argo", "asv1", "asv2", "aura", "aura2", "libdav1d", "libaom-av1", "av1", "av1_cuvid", "av1_qsv", "avrn", "avrp", "avs", "avui", "ayuv", "bethsoftvid", "bfi", "binkvideo", "bintext", "bitpacked", "bmp", "bmv_video", "brender_pix", "c93", "cavs", "cdgraphics", "cdtoons", "cdxl", "cfhd", "cinepak", "clearvideo", "cljr", "cllc", "eacmv", "cpia", "cri", "camstudio", "cyuv", "dds", "dfa", "dirac", "dnxhd", "dpx", "dsicinvideo", "dvvideo", "dxa", "dxtory", "dxv", "escape124", "escape130", "exr", "ffv1", "ffvhuff", "fic", "fits", "flashsv", "flashsv2", "flic", "flv", "fmvc", "fraps", "frwu", "g2m", "gdv", "gem", "gif", "h261", "h263", "h263_v4l2m2m", "h263i", "h263p", "h264", "h264_v4l2m2m", "h264_qsv", "h264_cuvid", "hap", "hdr", "hevc", "hevc_qsv", "hevc_v4l2m2m", "hevc_cuvid", "hnm4video", "hq_hqa", "hqx", "huffyuv", "hymt", "idcinvideo", "idf", "iff", "imm4", "imm5", "indeo2", "indeo3", "indeo4", "indeo5", "interplayvideo", "ipu", "jpeg2000", "jpegls", "libjxl", "jv", "kgv1", "kmvc", "lagarith", "loco", "lscr", "m101", "eamad", "magicyuv", "mdec", "media100", "mimic", "mjpeg", "mjpeg_cuvid", "mjpeg_qsv", "mjpegb", "mmvideo", "mobiclip", "motionpixels", "mpeg1video", "mpeg1_v4l2m2m", "mpeg1_cuvid", "mpeg2video", "mpegvideo", "mpeg2_v4l2m2m", "mpeg2_qsv", "mpeg2_cuvid", "mpeg4", "mpeg4_v4l2m2m", "mpeg4_cuvid", "msa1", "mscc", "msmpeg4v1", "msmpeg4v2", "msmpeg4", "msp2", "msrle", "mss1", "mss2", "msvideo1", "mszh", "mts2", "mv30", "mvc1", "mvc2", "mvdv", "mvha", "mwsc", "mxpeg", "notchlc", "nuv", "paf_video", "pam", "pbm", "pcx", "pdv", "pfm", "pgm", "pgmyuv", "pgx", "phm", "photocd", "pictor", "pixlet", "png", "ppm", "prores", "prosumer", "psd", "ptx", "qdraw", "qoi", "qpeg", "qtrle", "r10k", "r210", "rasc", "rawvideo", "rl2", "roqvideo", "rpza", "rscc", "rtv1", "rv10", "rv20", "rv30", "rv40", "sanm", "scpr", "screenpresso", "sga", "sgi", "sgirle", "sheervideo", "simbiosis_imx", "smackvid", "smc", "smvjpeg", "snow", "sp5x", "speedhq", "srgc", "sunrast", "librsvg", "svq1", "svq3", "targa", "targa_y216", "tdsc", "eatgq", "eatgv", "theora", "thp", "tiertexseqvideo", "tiff", "tmv", "eatqi", "truemotion1", "truemotion2", "truemotion2rt", "camtasia", "tscc2", "txd", "ultimotion", "utvideo", "v210", "v210x", "v308", "v408", "v410", "vb", "vble", "vbn", "vc1", "vc1_qsv", "vc1_v4l2m2m", "vc1_cuvid", "vc1image", "vcr1", "xl", "vmdvideo", "vmix", "vmnc", "vnull", "vp3", "vp4", "vp5", "vp6", "vp6a", "vp6f", "vp7", "vp8", "vp8_v4l2m2m", "libvpx", "vp8_cuvid", "vp8_qsv", "vp9", "vp9_v4l2m2m", "libvpx-vp9", "vp9_cuvid", "vp9_qsv", "vqc", "wbmp", "wcmv", "webp", "wmv1", "wmv2", "wmv3", "wmv3image", "wnv1", "wrapped_avframe", "vqavideo", "xan_wc3", "xan_wc4", "xbin", "xbm", "xface", "xpm", "xwd", "y41p", "ylc", "yop", "yuv4", "zerocodec", "zlib", "zmbv", "8svx_exp", "8svx_fib", "aac", "aac_fixed", "aac_latm", "ac3", "ac3_fixed", "acelp.kelvin", "adpcm_4xm", "adpcm_adx", "adpcm_afc", "adpcm_agm", "adpcm_aica", "adpcm_argo", "adpcm_ct", "adpcm_dtk", "adpcm_ea", "adpcm_ea_maxis_xa", "adpcm_ea_r1", "adpcm_ea_r2", "adpcm_ea_r3", "adpcm_ea_xas", "g722", "g726", "g726le", "adpcm_ima_acorn", "adpcm_ima_alp", "adpcm_ima_amv", "adpcm_ima_apc", "adpcm_ima_apm", "adpcm_ima_cunning", "adpcm_ima_dat4", "adpcm_ima_dk3", "adpcm_ima_dk4", "adpcm_ima_ea_eacs", "adpcm_ima_ea_sead", "adpcm_ima_iss", "adpcm_ima_moflex", "adpcm_ima_mtf", "adpcm_ima_oki", "adpcm_ima_qt", "adpcm_ima_rad", "adpcm_ima_smjpeg", "adpcm_ima_ssi", "adpcm_ima_wav", "adpcm_ima_ws", "adpcm_ms", "adpcm_mtaf", "adpcm_psx", "adpcm_sbpro_2", "adpcm_sbpro_3", "adpcm_sbpro_4", "adpcm_swf", "adpcm_thp", "adpcm_thp_le", "adpcm_vima", "adpcm_xa", "adpcm_xmd", "adpcm_yamaha", "adpcm_zork", "alac", "amrnb", "amrwb", "anull", "apac", "ape", "aptx", "aptx_hd", "atrac1", "atrac3", "atrac3al", "atrac3plus", "atrac3plusal", "atrac9", "on2avc", "binkaudio_dct", "binkaudio_rdft", "bmv_audio", "bonk", "cbd2_dpcm", "libcodec2", "comfortnoise", "cook", "derf_dpcm", "dfpwm", "dolby_e", "dsd_lsbf", "dsd_lsbf_planar", "dsd_msbf", "dsd_msbf_planar", "dsicinaudio", "dss_sp", "dst", "dca", "dvaudio", "eac3", "evrc", "fastaudio", "flac", "ftr", "g723_1", "g729", "gremlin_dpcm", "gsm", "libgsm", "gsm_ms", "libgsm_ms", "hca", "hcom", "iac", "ilbc", "imc", "interplay_dpcm", "interplayacm", "mace3", "mace6", "metasound", "misc4", "mlp", "mp1", "mp1float", "mp2", "mp2float", "mp3float", "mp3", "mp3adufloat", "mp3adu", "mp3on4float", "mp3on4", "als", "msnsiren", "mpc7", "mpc8", "nellymoser", "opus", "libopus", "osq", "paf_audio", "pcm_alaw", "pcm_bluray", "pcm_dvd", "pcm_f16le", "pcm_f24le", "pcm_f32be", "pcm_f32le", "pcm_f64be", "pcm_f64le", "pcm_lxf", "pcm_mulaw", "pcm_s16be", "pcm_s16be_planar", "pcm_s16le", "pcm_s16le_planar", "pcm_s24be", "pcm_s24daud", "pcm_s24le", "pcm_s24le_planar", "pcm_s32be", "pcm_s32le", "pcm_s32le_planar", "pcm_s64be", "pcm_s64le", "pcm_s8", "pcm_s8_planar", "pcm_sga", "pcm_u16be", "pcm_u16le", "pcm_u24be", "pcm_u24le", "pcm_u32be", "pcm_u32le", "pcm_u8", "pcm_vidc", "qcelp", "qdm2", "qdmc", "real_144", "real_288", "ralf", "rka", "roq_dpcm", "s302m", "sbc", "sdx2_dpcm", "shorten", "sipr", "siren", "smackaud", "sol_dpcm", "sonic", "speex", "libspeex", "tak", "truehd", "truespeech", "tta", "twinvq", "vmdaudio", "vorbis", "libvorbis", "wady_dpcm", "wavarc", "wavesynth", "wavpack", "ws_snd1", "wmalossless", "wmapro", "wmav1", "wmav2", "wmavoice", "xan_dpcm", "xma1", "xma2", "ssa", "ass", "dvbsub", "libzvbi_teletextdec", "dvdsub", "cc_dec", "pgssub", "jacosub", "microdvd", "mov_text", "mpl2", "pjs", "realtext", "sami", "stl", "srt", "subrip", "subviewer", "subviewer1", "text", "vplayer", "webvtt", "xsub"], "nvidia": {"h264_nvenc": true, "hevc_nvenc": true, "h264_cuvid": true, "hevc_cuvid": true, "cuda_hwaccel": true}}
```
